@using Sonorize.Core
@using Sonorize.Core.Services
@using Sonorize.Core.Services.UI
@using Sonorize.Core.Settings
@using Sonorize.Photino.Blazor.Components.Pages.Components
@using Sonorize.Photino.Blazor.Components.Pages.SettingsSections.Components
@using Sonorize.Photino.Blazor.Shared
@inject SonorizeSettings AppSettings
@inject ISettingsManager<SonorizeSettings> SettingsManager
@inject ThemeService ThemeService

<div class="settings-view-container">

    <!-- Saved Themes -->
    <SettingsCard Title="Saved Themes" Description="Switch between presets or saved styles">
        <HeaderAction>
            <button class="btn-header-action" @onclick="OpenSaveModal" title="Save Current">
                <i class="fas fa-save"></i> Save As...
            </button>
        </HeaderAction>
        <ChildContent>
            <ThemeListSection @ref="_themeList" OnLoadTheme="ApplyLoadedTheme" />
        </ChildContent>
    </SettingsCard>

    <!-- Player Bar Layout -->
    <SettingsCard Title="Player Bar Layout" Description="Drag widgets to reorder or move between zones" ContentStyle="padding:0;">
        <div style="padding: 15px;">
            <PlayerBarLayoutEditor Config="AppSettings.Theme.PlayerBarLayout" OnChange="Save" />
        </div>
    </SettingsCard>

    <!-- Layout & Geometry -->
    <ThemeLayoutCard />

    <!-- Colors & Background -->
    <ThemeColorsCard />

</div>

<SaveThemeModal IsVisible="_showSaveModal" OnClose="CloseSaveModal" OnConfirm="ConfirmSaveTheme" />