@page "/artists"
@using Sonorize.Core.Services
@using Sonorize.Core.Models
@using Sonorize.Core.Services.Library
@using Sonorize.Core.Settings
@using Sonorize.Photino.Blazor.Components.Pages.Components
@inject LibraryService LibService
@inject NavigationManager Nav
@inject SonorizeSettings AppSettings
@inject ISettingsManager<SonorizeSettings> SettingsManager
@implements IDisposable

<LibraryBrowser Title="Artists"
                TItem="ArtistGroup"
                Items="_artists"
                FilterPredicate="FilterArtist"
                ViewMode="AppSettings.Library.ArtistsViewMode"
                ViewModeChanged="OnViewModeChanged"
                OnItemClick="OpenArtist">

    <GridTemplate Context="artist">
        <div class="library-grid-item" @onclick="() => OpenArtist(artist)">
            <div class="art-wrapper" style="border-radius: 50%;">
                @if (artist.RepresentativeFilePath is not null)
                {
                    <img src="@GetArtUrl(artist.RepresentativeFilePath)" loading="lazy" style="border-radius: 50%;" />
                }
                else
                {
                    <div class="art-placeholder"><i class="fas fa-microphone"></i></div>
                }
            </div>
            <p class="item-title" style="text-align:center;" title="@artist.Name">@artist.Name</p>
            <p class="item-subtitle" style="text-align:center;">
                @artist.AlbumCount @(artist.AlbumCount == 1 ? "album" : "albums")  @artist.SongCount songs
            </p>
        </div>
    </GridTemplate>

    <TableHeader>
        <tr>
            <th class="col-art"></th>
            <th class="col-title sortable-header" @onclick='() => Sort("Name")'>
                Name @RenderSortIcon("Name")
            </th>
            <th class="col-duration sortable-header" @onclick='() => Sort("Albums")'>
                Albums @RenderSortIcon("Albums")
            </th>
            <th class="col-duration sortable-header" @onclick='() => Sort("Songs")'>
                Songs @RenderSortIcon("Songs")
            </th>
        </tr>
    </TableHeader>

    <RowTemplate Context="artist">
        <td class="col-art">
            <div class="list-art-wrapper" style="border-radius: 50%;">
                @if (artist.RepresentativeFilePath is not null)
                {
                    <img src="@GetArtUrl(artist.RepresentativeFilePath)" loading="lazy" />
                }
            </div>
        </td>
        <td class="col-title">@artist.Name</td>
        <td class="col-duration">@artist.AlbumCount</td>
        <td class="col-duration">@artist.SongCount</td>
    </RowTemplate>

</LibraryBrowser>