@using Sonorize.Core.Models
@using Sonorize.Core.Services

<div class="eq-preset-bar">
    <div class="eq-enable-wrapper">
        <label class="toggle-switch">
            <input type="checkbox" checked="@IsEnabled" @onchange="OnToggle" />
            <span class="toggle-slider"></span>
        </label>
        <span class="toggle-label">EQ On</span>
    </div>

    <div class="eq-actions">
        <select class="preset-select" value="@CurrentPresetName" @onchange="OnSelectChange">
            @if (CurrentPresetName == "__custom__")
            {
                <option value="__custom__">Custom</option>
            }
            <optgroup label="My Presets">
                @foreach (var p in UserPresets)
                {
                    <option value="@p.Name">@p.Name</option>
                }
            </optgroup>
            <optgroup label="Defaults">
                @foreach (var p in DefaultPresets)
                {
                    <option value="@p.Name">@p.Name</option>
                }
            </optgroup>
        </select>

        <div class="save-wrapper">
            <input type="text"
                   class="preset-name-input"
                   placeholder="Name..."
                   @bind="_saveName"
                   @bind:event="oninput" />

            <button class="icon-btn save"
                    disabled="@string.IsNullOrWhiteSpace(_saveName)"
                    @onclick="HandleSave"
                    title="Save Preset">
                <i class="fas fa-save"></i>
            </button>
        </div>

        <button class="icon-btn delete"
                disabled="@(!CanDelete)"
                @onclick="HandleDelete"
                title="Delete Preset">
            <i class="fas fa-trash"></i>
        </button>
    </div>
</div>