<div class="eq-bands-container">
    @for (int i = 0; i < 10; i++)
    {
        var index = i;
        <div class="eq-band">
            <div class="eq-slider-wrapper">
                <input type="range"
                       min="-15" max="15"
                       step="1"
                       value="@Gains[index]"
                       @oninput="@(e => HandleInput(index, e))"
                       class="vertical-slider" />
            </div>
            <span class="eq-freq" title="@_tooltips[index]">@_labels[index]</span>
        </div>
    }
</div>

<style>
    .eq-bands-container {
        display: flex;
        justify-content: space-between;
        height: 180px;
        width: 100%;
        padding: 10px 0;
    }

    .eq-band {
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100%;
        flex: 1;
        min-width: 20px;
    }

    .eq-slider-wrapper {
        width: 100%;
        height: 140px;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .vertical-slider {
        position: absolute;
        width: 140px;
        height: 20px;
        transform: rotate(-90deg);
        appearance: none;
        background: transparent;
        cursor: pointer;
        margin: 0;
    }

        .vertical-slider::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 2px;
            cursor: pointer;
        }

        .vertical-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            background: var(--accent-primary);
            border-radius: 50%;
            margin-top: -6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
            cursor: grab;
        }

        .vertical-slider:focus {
            outline: none;
        }

    .eq-freq {
        margin-top: auto;
        font-size: 0.7em;
        color: var(--text-secondary);
        font-family: monospace;
        cursor: help;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
</style>

@code {
    [Parameter] public float[] Gains { get; set; } = new float[10];
    [Parameter] public EventCallback<(int Index, float Value)> OnGainChanged { get; set; }

    private readonly string[] _labels = ["Sub", "Bass", "Low", "Body", "Mid", "Voc", "Pres", "Def", "High", "Air"];
    private readonly string[] _tooltips = ["31 Hz", "63 Hz", "125 Hz", "250 Hz", "500 Hz", "1 kHz", "2 kHz", "4 kHz", "8 kHz", "16 kHz"];

    private async Task HandleInput(int index, ChangeEventArgs e)
    {
        if (float.TryParse(e.Value?.ToString(), out float val))
        {
            await OnGainChanged.InvokeAsync((index, val));
        }
    }
}